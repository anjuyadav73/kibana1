!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var n in s)("object"==typeof exports?exports:t)[n]=s[n]}}(window,(function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([,function(t,e,s){(function(e){const n=s(3),o="undefined"==typeof window?e:window;o.loaders=o.loaders||{},t.exports=Object.assign(o.loaders,n)}).call(this,s(2))},function(t,e){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},function(t,e,s){"use strict";s.r(e),s.d(e,"JSONLoader",(function(){return et})),s.d(e,"_GeoJSONLoader",(function(){return mt})),s.d(e,"_GeoJSONWorkerLoader",(function(){return bt})),s.d(e,"_JSONPath",(function(){return H})),s.d(e,"_ClarinetParser",(function(){return G}));const n={batchSize:"auto",convertToObject:!0};class o{constructor(t,e={}){if(e={...n,...e},this.schema=t,this.batchSize=e.batchSize,this.convertToObject=e.convertToObject,this.rows=null,this.length=0,this.isChunkComplete=!1,this.cursor=0,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}addRow(t,e=null){this.rows||(this.rows=new Array(this.batchSize),this.length=0),Number.isFinite(e)&&(this.cursor=e);const s=this.convertToObject&&this.schema;this.rows[this.length]=s?function(t,e){if(!t)throw new Error("null row");if(!Array.isArray(t))return t;if(!e)return t;const s={};for(let n=0;n<e.length;n++)s[e[n]]=t[n];return s}(t,this._headers):t,this.length++}chunkComplete(){this.isChunkComplete=!0}isFull(){return"auto"===this.batchSize?this.isChunkComplete&&this.length>0:this.rows&&this.length>=this.batchSize}getBatch(){if(this.rows){const t=this.rows.slice(0,this.length);return this.rows=null,this.isChunkComplete=!1,{data:t,schema:this.schema,length:t.length,cursor:this.cursor}}return null}}function i(t,e){try{const s=JSON.parse(t);return e.json.table&&function t(e){if(Array.isArray(e))return e;if(e&&"object"==typeof e)for(const s of Object.values(e)){const e=t(s);if(e)return e}return null}(s)||s}catch(t){throw new Error("JSONLoader: failed to parse JSON")}}const r={batchSize:100};class a{constructor(t,e,s={}){this.TableBatchType=t,this.schema=e,this.options={...r,...s},this.batch=null,this.batchCount=0,this.bytesUsed=0}addRow(t){if(!this.batch){const{TableBatchType:t}=this;this.batch=new t(this.schema,this.options)}this.batch.addRow(t)}chunkComplete(t){this.bytesUsed+=t.byteLength||t.length||0,this.batch&&this.batch.chunkComplete()}isFull(){return this.batch&&this.batch.isFull()}hasBatch(){return Boolean(this.batch)}getBatch(t={}){if(Number.isFinite(t.bytesUsed)&&(this.bytesUsed=t.bytesUsed),this.batch){const e=this.batch.getBatch();return this.batch=null,e.count=this.batchCount,this.batchCount++,e.bytesUsed=this.bytesUsed,Object.assign(e,t),e}return null}}const h=Number.MAX_SAFE_INTEGER,c="debug"==={}.CDEBUG,u={textNode:void 0,numberNode:""};let l=0;const p={BEGIN:l++,VALUE:l++,OPEN_OBJECT:l++,CLOSE_OBJECT:l++,OPEN_ARRAY:l++,CLOSE_ARRAY:l++,TEXT_ESCAPE:l++,STRING:l++,BACKSLASH:l++,END:l++,OPEN_KEY:l++,CLOSE_KEY:l++,TRUE:l++,TRUE2:l++,TRUE3:l++,FALSE:l++,FALSE2:l++,FALSE3:l++,FALSE4:l++,NULL:l++,NULL2:l++,NULL3:l++,NUMBER_DECIMAL_POINT:l++,NUMBER_DIGIT:l++};for(var d in p)p[p[d]]=d;l=p;const f=9,g=10,y=13,b=32,m=34,P=43,S=44,w=45,A=46,j=48,E=57,O=58,v=69,C=91,N=92,L=93,_=97,I=98,k=101,U=102,x=108,T=110,F=114,R=115,B=116,J=117,z=123,M=125;var Y=/[\\"\n]/g;class G{constructor(t={}){this._initialize(t)}_initialize(t){this._clearBuffers(this),this.bufferCheckPosition=h,this.q="",this.c="",this.p="",this.options=t||{},this.closed=!1,this.closedRoot=!1,this.sawRoot=!1,this.tag=null,this.error=null,this.state=l.BEGIN,this.stack=new Array,this.position=this.column=0,this.line=1,this.slashed=!1,this.unicodeI=0,this.unicodeS=null,this.depth=0,"onready"in t&&(this.onready=t.onready),"onopenobject"in t&&(this.onopenobject=t.onopenobject),"onkey"in t&&(this.onkey=t.onkey),"oncloseobject"in t&&(this.oncloseobject=t.oncloseobject),"onopenarray"in t&&(this.onopenarray=t.onopenarray),"onclosearray"in t&&(this.onclosearray=t.onclosearray),"onvalue"in t&&(this.onvalue=t.onvalue),"onerror"in t&&(this.onerror=t.onerror),"onend"in t&&(this.onend=t.onend),"onchunkparsed"in t&&(this.onchunkparsed=t.onchunkparsed),V(this,"onready")}_clearBuffers(){for(var t in u)this[t]=u[t]}end(){return this.state===l.VALUE&&0===this.depth||q(this,"Unexpected end"),K(this),this.c="",this.closed=!0,V(this,"onend"),this._initialize(this.options),this}resume(){return this.error=null,this}close(){return this.write(null)}write(t){if(this.error)throw this.error;if(this.closed)return q(this,"Cannot write after close. Assign an onready handler.");if(null===t)return this.end();var e=0,s=t.charCodeAt(0),n=this.p;for(c&&console.log("write -> ["+t+"]");s&&(n=s,this.c=s=t.charCodeAt(e++),n!==s?this.p=n:n=this.p,s);)switch(c&&console.log(e,s,p[this.state]),this.position++,s===g?(this.line++,this.column=0):this.column++,this.state){case l.BEGIN:s===z?this.state=l.OPEN_OBJECT:s===C?this.state=l.OPEN_ARRAY:X(s)||q(this,"Non-whitespace before {[.");continue;case l.OPEN_KEY:case l.OPEN_OBJECT:if(X(s))continue;if(this.state===l.OPEN_KEY)this.stack.push(l.CLOSE_KEY);else{if(s===M){V(this,"onopenobject"),this.depth++,V(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||l.VALUE;continue}this.stack.push(l.CLOSE_OBJECT)}s===m?this.state=l.STRING:q(this,'Malformed object key should start with "');continue;case l.CLOSE_KEY:case l.CLOSE_OBJECT:if(X(s))continue;this.state,l.CLOSE_KEY;s===O?(this.state===l.CLOSE_OBJECT?(this.stack.push(l.CLOSE_OBJECT),K(this,"onopenobject"),this.depth++):K(this,"onkey"),this.state=l.VALUE):s===M?(D(this,"oncloseobject"),this.depth--,this.state=this.stack.pop()||l.VALUE):s===S?(this.state===l.CLOSE_OBJECT&&this.stack.push(l.CLOSE_OBJECT),K(this),this.state=l.OPEN_KEY):q(this,"Bad object");continue;case l.OPEN_ARRAY:case l.VALUE:if(X(s))continue;if(this.state===l.OPEN_ARRAY){if(V(this,"onopenarray"),this.depth++,this.state=l.VALUE,s===L){V(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||l.VALUE;continue}this.stack.push(l.CLOSE_ARRAY)}s===m?this.state=l.STRING:s===z?this.state=l.OPEN_OBJECT:s===C?this.state=l.OPEN_ARRAY:s===B?this.state=l.TRUE:s===U?this.state=l.FALSE:s===T?this.state=l.NULL:s===w?this.numberNode+="-":j<=s&&s<=E?(this.numberNode+=String.fromCharCode(s),this.state=l.NUMBER_DIGIT):q(this,"Bad value");continue;case l.CLOSE_ARRAY:if(s===S)this.stack.push(l.CLOSE_ARRAY),K(this,"onvalue"),this.state=l.VALUE;else if(s===L)D(this,"onclosearray"),this.depth--,this.state=this.stack.pop()||l.VALUE;else{if(X(s))continue;q(this,"Bad array")}continue;case l.STRING:void 0===this.textNode&&(this.textNode="");var o=e-1,i=this.slashed,r=this.unicodeI;t:for(;;){for(c&&console.log(e,s,p[this.state],i);r>0;)if(this.unicodeS+=String.fromCharCode(s),s=t.charCodeAt(e++),this.position++,4===r?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),r=0,o=e-1):r++,!s)break t;if(s===m&&!i){this.state=this.stack.pop()||l.VALUE,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(s===N&&!i&&(i=!0,this.textNode+=t.substring(o,e-1),this.position+=e-1-o,s=t.charCodeAt(e++),this.position++,!s))break;if(i){if(i=!1,s===T?this.textNode+="\n":s===F?this.textNode+="\r":s===B?this.textNode+="\t":s===U?this.textNode+="\f":s===I?this.textNode+="\b":s===J?(r=1,this.unicodeS=""):this.textNode+=String.fromCharCode(s),s=t.charCodeAt(e++),this.position++,o=e-1,s)continue;break}Y.lastIndex=e;var a=Y.exec(t);if(null===a){e=t.length+1,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(e=a.index+1,!(s=t.charCodeAt(a.index))){this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}}this.slashed=i,this.unicodeI=r;continue;case l.TRUE:s===F?this.state=l.TRUE2:q(this,"Invalid true started with t"+s);continue;case l.TRUE2:s===J?this.state=l.TRUE3:q(this,"Invalid true started with tr"+s);continue;case l.TRUE3:s===k?(V(this,"onvalue",!0),this.state=this.stack.pop()||l.VALUE):q(this,"Invalid true started with tru"+s);continue;case l.FALSE:s===_?this.state=l.FALSE2:q(this,"Invalid false started with f"+s);continue;case l.FALSE2:s===x?this.state=l.FALSE3:q(this,"Invalid false started with fa"+s);continue;case l.FALSE3:s===R?this.state=l.FALSE4:q(this,"Invalid false started with fal"+s);continue;case l.FALSE4:s===k?(V(this,"onvalue",!1),this.state=this.stack.pop()||l.VALUE):q(this,"Invalid false started with fals"+s);continue;case l.NULL:s===J?this.state=l.NULL2:q(this,"Invalid null started with n"+s);continue;case l.NULL2:s===x?this.state=l.NULL3:q(this,"Invalid null started with nu"+s);continue;case l.NULL3:s===x?(V(this,"onvalue",null),this.state=this.stack.pop()||l.VALUE):q(this,"Invalid null started with nul"+s);continue;case l.NUMBER_DECIMAL_POINT:s===A?(this.numberNode+=".",this.state=l.NUMBER_DIGIT):q(this,"Leading zero not followed by .");continue;case l.NUMBER_DIGIT:j<=s&&s<=E?this.numberNode+=String.fromCharCode(s):s===A?(-1!==this.numberNode.indexOf(".")&&q(this,"Invalid number has two dots"),this.numberNode+="."):s===k||s===v?(-1===this.numberNode.indexOf("e")&&-1===this.numberNode.indexOf("E")||q(this,"Invalid number has two exponential"),this.numberNode+="e"):s===P||s===w?(n!==k&&n!==v&&q(this,"Invalid symbol in number"),this.numberNode+=String.fromCharCode(s)):($(this),e--,this.state=this.stack.pop()||l.VALUE);continue;default:q(this,"Unknown state: "+this.state)}return this.position>=this.bufferCheckPosition&&function(t){const e=Math.max(h,10);let s=0;for(var n in u){var o=void 0===t[n]?0:t[n].length;if(o>e)switch(n){case"text":closeText(t);break;default:q(t,"Max buffer length exceeded: "+n)}s=Math.max(s,o)}t.bufferCheckPosition=h-s+t.position}(this),V(this,"onchunkparsed"),this}}function V(t,e,s){c&&console.log("-- emit",e,s),t[e]&&t[e](s,t)}function D(t,e,s){K(t),V(t,e,s)}function K(t,e){t.textNode=function(t,e){if(void 0===e)return e;t.trim&&(e=e.trim());t.normalize&&(e=e.replace(/\s+/g," "));return e}(t.options,t.textNode),void 0!==t.textNode&&V(t,e||"onvalue",t.textNode),t.textNode=void 0}function $(t){t.numberNode&&V(t,"onvalue",parseFloat(t.numberNode)),t.numberNode=""}function q(t,e){return K(t),e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c,e=new Error(e),t.error=e,V(t,"onerror",e),t}function X(t){return t===y||t===g||t===b||t===f}class H{constructor(t=null){if(this.path=["$"],t instanceof H)this.path=[...t.path];else if(Array.isArray(t))this.path.push(...t);else if("string"==typeof t&&(this.path=t.split("."),"$"!==this.path[0]))throw new Error("JSONPaths must start with $")}clone(){return new H(this)}toString(){return this.path.join(".")}push(t){this.path.push(t)}pop(){return this.path.pop()}set(t){this.path[this.path.length-1]=t}equals(t){if(!this||!t||this.path.length!==t.path.length)return!1;for(let e=0;e<this.path.length;++e)if(this.path[e]!==t.path[e])return!1;return!0}setFieldAtPath(t,e){const s=[...this.path];s.shift();const n=s.pop();for(const e of s)t=t[e];t[n]=e}getFieldAtPath(t){const e=[...this.path];e.shift();const s=e.pop();for(const s of e)t=t[s];return t[s]}}class W extends class{constructor(){this.reset(),this._initializeParser()}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new H}write(t){this.parser.write(t)}close(){this.parser.close()}_pushOrSet(t){const{container:e,key:s}=this.currentState;null!==s?(e[s]=t,this.currentState.key=null):e.push(t)}_openArray(t=[]){this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(t={}){this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_initializeParser(){this.parser=new G({onready:()=>{this.jsonpath=new H,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:t=>{this._openObject({}),void 0!==t&&this.parser.onkey(t)},onkey:t=>{this.jsonpath.set(t),this.currentState.key=t},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:t=>{this._pushOrSet(t)},onerror:t=>{throw t},onend:()=>{this.result=this.currentState.container.pop()}})}}{constructor(t={}){super();const e=t.jsonpaths||[];this.jsonPaths=e.map(t=>new H(t)),this.streamingJsonPath=null,this.streamingArray=null,this.topLevelObject=null,this._extendParser()}write(t){super.write(t);let e=[];return this.streamingArray&&(e=[...this.streamingArray],this.streamingArray.length=0),e}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const t=this.getJsonPath();if(0===this.jsonPaths.length)return!0;for(const e of this.jsonPaths)if(e.equals(t))return!0;return!1}_extendParser(){this.parser.onopenarray=()=>{if(!this.streamingArray&&this._matchJSONPath())return this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],void this._openArray(this.streamingArray);this._openArray()},this.parser.onopenobject=t=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),void 0!==t&&this.parser.onkey(t)}}}async function*Q(t,e){t=async function*(t,e){const s=new TextDecoder(e);for await(const e of t)yield"string"==typeof e?e:s.decode(e,{stream:!0})}(t);const{metadata:s}=e,{batchSize:n,_rootObjectBatches:o,jsonpaths:i}=e.json,r=e.json.TableBatch;let h=!0,c=null,u=null;const l=new W({jsonpaths:i});c=c||new a(r,u,{batchSize:n});for await(const e of t){const t=l.write(e),n=t.length>0&&l.getStreamingJsonPathAsString();if(t.length>0&&h){if(s){const t={batchType:"partial-result",container:l.getPartialResult(),data:[],bytesUsed:0,schema:null,jsonpath:n};yield t}if(o){const t={batchType:"root-object-batch-partial",container:l.getPartialResult(),data:[],schema:null};yield t}h=!1,u=Z(t)}for(const e of t)c.addRow(e),c.isFull()&&(yield c.getBatch({jsonpath:n}));c.chunkComplete(e),c.isFull()&&(yield c.getBatch({jsonpath:n}))}const p=l.getStreamingJsonPathAsString(),d=c.getBatch({jsonpath:p});if(d&&(yield d),s){const t={batchType:"final-result",container:l.getPartialResult(),jsonpath:l.getStreamingJsonPathAsString(),data:[],schema:null};yield t}if(o){const t={batchType:"root-object-batch-complete",container:l.getPartialResult(),data:[],schema:null};yield t}}function Z(t){const e=t[0],s={};let n=0;for(const t in e){switch(typeof e[t]){case"number":case"boolean":s[t]={name:String(t),index:n,type:Float32Array};break;case"object":s[t]={name:String(t),index:n,type:Array};break;case"string":default:s[t]={name:String(t),index:n,type:Array}}n++}return s}const tt={json:{TableBatch:o,batchSize:"auto",_rootObjectBatches:!1,table:!1,jsonpaths:[]}},et={id:"json",name:"JSON",version:"2.3.1",extensions:["json","geojson"],mimeTypes:["application/json"],category:"table",text:!0,parse:async function(t,e){return st((new TextDecoder).decode(t),e)},parseTextSync:st,parseInBatches:async function(t,e){return(e={...tt,...e}).json={...tt.json,...e.json},Q(t,e)},options:tt,deprecatedOptions:{json:{_rootObjectBatches:"metadata"}}};function st(t,e){return(e={...tt,...e}).json={...tt.json,...e.json},i(t,e)}function nt(t,e={}){const s=ot(t);return it(t,s,{coordLength:e.coordLength||s.coordLength,numericPropKeys:e.numericPropKeys||s.numericPropKeys,PositionDataType:e.PositionDataType||Float32Array})}function ot(t){let e=0,s=0,n=0,o=0,i=0,r=0,a=0,h=0,c=0;const u=new Set,l={};for(const d of t){const t=d.geometry;switch(t.type){case"Point":s++,e++,u.add(t.coordinates.length);break;case"MultiPoint":s++,e+=t.coordinates.length;for(const e of t.coordinates)u.add(e.length);break;case"LineString":i++,n+=t.coordinates.length,o++;for(const e of t.coordinates)u.add(e.length);break;case"MultiLineString":i++;for(const e of t.coordinates){n+=e.length,o++;for(const t of e)u.add(t.length)}break;case"Polygon":c++,a++,h+=t.coordinates.length,r+=gt(t.coordinates).length;for(const e of gt(t.coordinates))u.add(e.length);break;case"MultiPolygon":c++;for(const e of t.coordinates){a++,h+=e.length,r+=gt(e).length;for(const t of gt(e))u.add(t.length)}break;default:throw new Error("Unsupported geometry type: "+t.type)}if(d.properties)for(const t in d.properties){const e=d.properties[t];l[t]=l[t]||void 0===l[t]?(p=e,Number.isFinite(p)):l[t]}}var p;return{pointPositionsCount:e,pointFeaturesCount:s,linePositionsCount:n,linePathsCount:o,lineFeaturesCount:i,coordLength:Math.max(...u),polygonPositionsCount:r,polygonObjectsCount:a,polygonRingsCount:h,polygonFeaturesCount:c,numericPropKeys:Object.keys(l).filter(t=>l[t])}}function it(t,e={},s={}){const{pointPositionsCount:n,pointFeaturesCount:o,linePositionsCount:i,linePathsCount:r,lineFeaturesCount:a,polygonPositionsCount:h,polygonObjectsCount:c,polygonRingsCount:u,polygonFeaturesCount:l}=e,{coordLength:p,numericPropKeys:d,PositionDataType:f=Float32Array}=s,g=t.length>65535?Uint32Array:Uint16Array,y={positions:new f(n*p),globalFeatureIds:new g(n),featureIds:o>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[]},b={pathIndices:i>65535?new Uint32Array(r+1):new Uint16Array(r+1),positions:new f(i*p),globalFeatureIds:new g(i),featureIds:a>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[]},m={polygonIndices:h>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:h>65535?new Uint32Array(u+1):new Uint16Array(u+1),positions:new f(h*p),globalFeatureIds:new g(h),featureIds:l>65535?new Uint32Array(h):new Uint16Array(h),numericProps:{},properties:[]};for(const t of[y,b,m])for(const e of d)t.numericProps[e]=new Float32Array(t.positions.length/p);b.pathIndices[r]=i,m.polygonIndices[c]=h,m.primitivePolygonIndices[u]=h;const P={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const e of t){const t=e.geometry,s=e.properties;switch(t.type){case"Point":rt(t.coordinates,y,P,p,s),y.properties.push(dt(s,d)),P.pointFeature++;break;case"MultiPoint":at(t.coordinates,y,P,p,s),y.properties.push(dt(s,d)),P.pointFeature++;break;case"LineString":ht(t.coordinates,b,P,p,s),b.properties.push(dt(s,d)),P.lineFeature++;break;case"MultiLineString":ct(t.coordinates,b,P,p,s),b.properties.push(dt(s,d)),P.lineFeature++;break;case"Polygon":ut(t.coordinates,m,P,p,s),m.properties.push(dt(s,d)),P.polygonFeature++;break;case"MultiPolygon":lt(t.coordinates,m,P,p,s),m.properties.push(dt(s,d)),P.polygonFeature++;break;default:throw new Error("Invalid geometry type")}P.feature++}return function(t,e,s,n){const o={points:{positions:{value:t.positions,size:n},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:t.numericProps,properties:t.properties},lines:{pathIndices:{value:e.pathIndices,size:1},positions:{value:e.positions,size:n},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:e.numericProps,properties:e.properties},polygons:{polygonIndices:{value:s.polygonIndices,size:1},primitivePolygonIndices:{value:s.primitivePolygonIndices,size:1},positions:{value:s.positions,size:n},globalFeatureIds:{value:s.globalFeatureIds,size:1},featureIds:{value:s.featureIds,size:1},numericProps:s.numericProps,properties:s.properties}};for(const t in o)for(const e in o[t].numericProps)o[t].numericProps[e]={value:o[t].numericProps[e],size:1};return o}(y,b,m,p)}function rt(t,e,s,n,o){e.positions.set(t,s.pointPosition*n),e.globalFeatureIds[s.pointPosition]=s.feature,e.featureIds[s.pointPosition]=s.pointFeature,pt(e,o,s.pointPosition,1),s.pointPosition++}function at(t,e,s,n,o){for(const i of t)rt(i,e,s,n,o)}function ht(t,e,s,n,o){e.pathIndices[s.linePath]=s.linePosition,s.linePath++,ft(e.positions,t,s.linePosition,n);const i=t.length;pt(e,o,s.linePosition,i),e.globalFeatureIds.set(new Uint32Array(i).fill(s.feature),s.linePosition),e.featureIds.set(new Uint32Array(i).fill(s.lineFeature),s.linePosition),s.linePosition+=i}function ct(t,e,s,n,o){for(const i of t)ht(i,e,s,n,o)}function ut(t,e,s,n,o){e.polygonIndices[s.polygonObject]=s.polygonPosition,s.polygonObject++;for(const i of t){e.primitivePolygonIndices[s.polygonRing]=s.polygonPosition,s.polygonRing++,ft(e.positions,i,s.polygonPosition,n);const t=i.length;pt(e,o,s.polygonPosition,t),e.globalFeatureIds.set(new Uint32Array(t).fill(s.feature),s.polygonPosition),e.featureIds.set(new Uint32Array(t).fill(s.polygonFeature),s.polygonPosition),s.polygonPosition+=t}}function lt(t,e,s,n,o){for(const i of t)ut(i,e,s,n,o)}function pt(t,e,s,n){for(const o in t.numericProps)o in e&&t.numericProps[o].set(new Array(n).fill(e[o]),s)}function dt(t,e){for(const s in t)e.includes(s)&&delete t[s];return t}function ft(t,e,s,n){let o=s*n;for(const s of e)t.set(s,o),o+=n}function gt(t){return[].concat(...t)}const yt={geojson:{TableBatch:o,batchSize:"auto",workerUrl:"https://unpkg.com/@loaders.gl/json@2.3.1/dist/geojson-loader.worker.js"},json:{jsonpaths:["$","$.features"]},gis:{format:"geojson"}},bt={id:"geojson",name:"GeoJSON",version:"2.3.1",extensions:["geojson"],mimeTypes:["application/geo+json"],category:"geometry",text:!0,options:yt},mt={...bt,parse:async function(t,e){return Pt((new TextDecoder).decode(t),e)},parseTextSync:Pt,parseInBatches:async function(t,e){(e={...yt,...e}).json={...yt.geojson,...e.geojson};const s=Q(t,e);switch(e.gis.format){case"binary":return async function*(t){for await(const e of t)e.data=nt(e.data),yield e}(s);default:return s}}};function Pt(t,e){(e={...yt,...e}).json={...yt.geojson,...e.geojson},e.gis=e.gis||{};const s=i(t,e);switch(e.gis.format){case"binary":return nt(s);default:return s}}}])}));